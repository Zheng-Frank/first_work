export class ImageItem {
    _id?: string;
    aliases: string[];
    cuisines?: string[];
    images?: any[];
    menuCount?: number;
    orderCount?: number;

    public static areAliasesSame(alias1, alias2) {
        if (alias1 === alias2) {
            return true;
        }
        if (!alias1 || !alias2) { // if any of them are empty, just return false
            return false;
        }
        const a1 = ImageItem.extractAliases(alias1).map(a => a.alias);
        const a2 = ImageItem.extractAliases(alias2).map(a => a.alias);
        const sharedAlias = a1.some(a => a2.indexOf(a) >= 0);
        const distanceOk = a1.some(a => a2.some(b => a.length >= 8 && ImageItem.levenshteinDistance(a, b) <= 2));
        // when levenshtein distance <=2, we call them the same thing
        return sharedAlias || distanceOk;
    }

    // extract alias and language pairs from name
    public static extractAliases(name) {
        // name = '#1 L11. Sesame  ChickenèŠéº»  é¸¡ å¤§ã€Combã€‘SautÃ©ed Fish Filets with Basilä¹å±‚å¡”é±¼ç‰‡ðŸŒ¶ï¸';
        // https://stackoverflow.com/questions/14313183/javascript-regex-how-do-i-check-if-the-string-is-ascii-only
        // https://flyingsky.github.io/2018/01/26/javascript-detect-chinese-japanese/
        const languageRegexMap = {
            EN: /^[\x00-\x7F]*$/,
            ZH: /[\u4e00-\u9fff]|[\u3400-\u4dbf]|[\u{20000}-\u{2a6df}]|[\u{2a700}-\u{2b73f}]|[\u{2b740}-\u{2b81f}]|[\u{2b820}-\u{2ceaf}]|[\uf900-\ufaff]|[\u3300-\u33ff]|[\ufe30-\ufe4f]|[\uf900-\ufaff]|[\u{2f800}-\u{2fa1f}]/u,
            JA: /[\u3000-\u303f]|[\u3040-\u309f]|[\u30a0-\u30ff]|[\uff00-\uff9f]|[\u4e00-\u9faf]|[\u3400-\u4dbf]/,
            KO: /[\u3131-\uD79D]/ugi,
            // ...more if needed
        };

        // 0. convert all to lowercase, ç¹ä½“è½¬ç®€ä½“
        name = name.toLowerCase();
        const sc = 'é”•çš‘è”¼ç¢çˆ±å—³å«’ç‘·æš§éœ­è°™é“µé¹Œè‚®è¢„å¥¥åªªéªœé³Œåç½¢é’¯æ‘†è´¥å‘—é¢åŠžç»Šé’£å¸®ç»‘é•‘è°¤å‰¥é¥±å®æŠ¥é²é¸¨é¾…è¾ˆè´é’¡ç‹ˆå¤‡æƒ«é¹Žè´²é”›ç»·ç¬”æ¯•æ¯™å¸é—­èœå“”æ»—é“‹ç­šè·¸è¾¹ç¼–è´¬å˜è¾©è¾«è‹„ç¼ç¬¾æ ‡éª é£‘é£™é•–é•³é³”é³–åˆ«ç˜ªæ¿’æ»¨å®¾æ‘ˆå‚§ç¼¤æ§Ÿæ®¡è†‘é•”é«Œé¬“é¥¼ç¦€æ‹¨é’µé“‚é©³é¥½é’¹é¹è¡¥é’¸è´¢å‚èš•æ®‹æƒ­æƒ¨ç¿éª–é»ªè‹èˆ±ä»“æ²§åŽ•ä¾§å†Œæµ‹æ»å±‚è¯§é”¸ä¾ªé’—æ€æŽºè‰é¦‹è°—ç¼ é“²äº§é˜é¢¤å†è°„è°¶è’‡å¿å©µéª£è§‡ç¦…é•¡åœºå°é•¿å¿è‚ åŽ‚ç•…ä¼¥è‹Œæ€…é˜Šé²³é’žè½¦å½»ç —å°˜é™ˆè¡¬ä¼§è°Œæ¦‡ç¢œé¾€æ’‘ç§°æƒ©è¯šéª‹æž¨æŸ½é“–é“›ç—´è¿Ÿé©°è€»é½¿ç‚½é¥¬é¸±å†²å†²è™«å® é“³ç•´è¸Œç­¹ç»¸ä¿¦å¸±é› æ©±åŽ¨é”„é›ç¡€å‚¨è§¦å¤„åˆç»Œè¹°ä¼ é’ç–®é—¯åˆ›æ€†é”¤ç¼çº¯é¹‘ç»°è¾é¾Šè¾žè¯èµé¹šèªè‘±å›±ä»Žä¸›è‹éª¢æžžå‡‘è¾è¹¿çªœæ’ºé”™é”‰é¹¾è¾¾å“’éž‘å¸¦è´·éª€ç»æ‹…å•éƒ¸æŽ¸èƒ†æƒ®è¯žå¼¹æ®šèµ•ç˜…ç®ªå½“æŒ¡å…šè¡æ¡£è° ç €è£†æ£å²›ç¥·å¯¼ç›—ç„˜ç¯é‚“é•«æ•Œæ¶¤é€’ç¼”ç±´è¯‹è°›ç»¨è§Œé•é¢ ç‚¹åž«ç”µå·…é’¿ç™«é’“è°ƒé“«é²·è°å é²½é’‰é¡¶é”­è®¢é“¤ä¸¢é“¥ä¸œåŠ¨æ ‹å†»å²½é¸«çª¦çŠŠç‹¬è¯»èµŒé•€æ¸Žæ¤Ÿç‰ç¬ƒé»©é”»æ–­ç¼Žç°–å…‘é˜Ÿå¯¹æ€¼é•¦å¨é¡¿é’ç‚–è¶¸å¤ºå •é“Žé¹…é¢è®¹æ¶é¥¿è°”åž©é˜è½­é”‡é”·é¹—é¢šé¢›é³„è¯¶å„¿å°”é¥µè´°è¿©é“’é¸¸é²•å‘ç½šé˜€ççŸ¾é’’çƒ¦è´©é¥­è®¿çººé’«é²‚é£žè¯½åºŸè´¹ç»¯é•„é²±çº·åŸå¥‹æ„¤ç²ªå¾ä¸°æž«é”‹é£Žç–¯å†¯ç¼è®½å‡¤æ²£è‚¤è¾æŠšè¾…èµ‹å¤è´Ÿè®£å¦‡ç¼šå‡«é©¸ç»‚ç»‹èµ™éº¸é²‹é³†é’†è¯¥é’™ç›–èµ…æ†èµ¶ç§†èµ£å°´æ“€ç»€å†ˆåˆšé’¢çº²å²—æˆ†é•ç¾è¯°ç¼Ÿé”†æé¸½é˜é“¬ä¸ªçº¥é•‰é¢ç»™äº˜èµ“ç» é² é¾šå®«å·©è´¡é’©æ²Ÿè‹Ÿæž„è´­å¤Ÿè¯Ÿç¼‘è§è›Šé¡¾è¯‚æ¯‚é’´é”¢é¸ªé¹„é¹˜å‰æŒ‚é¸¹æŽ´å…³è§‚é¦†æƒ¯è´¯è¯–æŽ¼é¹³é³å¹¿çŠ·è§„å½’é¾Ÿé—ºè½¨è¯¡è´µåˆ½åŒ¦åˆ¿å¦«æ¡§é²‘é³œè¾Šæ»šè¡®ç»²é²§é”…å›½è¿‡åŸšå‘™å¸¼æ¤èˆé“ªéª‡éŸ©æ±‰é˜šç»—é¢‰å·çé¢¢é˜‚é¹¤è´ºè¯ƒé˜–è›Žæ¨ªè½°é¸¿çº¢é»‰è®§è­é—³é²Žå£¶æŠ¤æ²ªæˆ·æµ’é¹•å“—åŽç”»åˆ’è¯éª…æ¡¦é“§æ€€åæ¬¢çŽ¯è¿˜ç¼“æ¢å”¤ç—ªç„•æ¶£å¥‚ç¼³é”¾é²©é»„è°Žé³‡æŒ¥è¾‰æ¯è´¿ç§½ä¼šçƒ©æ±‡è®³è¯²ç»˜è¯™èŸå“•æµç¼‹ç²æ™–è¤æµ‘è¯¨é¦„é˜èŽ·è´§ç¥¸é’¬é•¬å‡»æœºç§¯é¥¥è¿¹è®¥é¸¡ç»©ç¼‰æžè¾‘çº§æŒ¤å‡ è“Ÿå‰‚æµŽè®¡è®°é™…ç»§çºªè®¦è¯˜è å½å“œéª¥çŽ‘è§Šé½‘çŸ¶ç¾è™¿è·»éœé²šé²«å¤¹èšé¢Šè´¾é’¾ä»·é©¾éƒæµƒé“—é•“è›²æ­¼ç›‘åšç¬ºé—´è‰°ç¼„èŒ§æ£€ç¢±ç¡·æ‹£æ¡ç®€ä¿­å‡èæ§›é‰´è·µè´±è§é”®èˆ°å‰‘é¥¯æ¸æº…æ¶§è°ç¼£æˆ‹æˆ¬ç‘é¹£ç¬•é²£éž¯å°†æµ†è’‹æ¡¨å¥–è®²é…±ç»›ç¼°èƒ¶æµ‡éª„å¨‡æ…é“°çŸ«ä¾¥è„šé¥ºç¼´ç»žè½¿è¾ƒæŒ¢å³¤é¹ªé²›é˜¶èŠ‚æ´ç»“è¯«å±Šç––é¢Œé²’ç´§é”¦ä»…è°¨è¿›æ™‹çƒ¬å°½åŠ²è†èŒŽåºè©é¦‘ç¼™èµ†è§é²¸æƒŠç»é¢ˆé™é•œå¾„ç—‰ç«žå‡€åˆ­æ³¾è¿³å¼ªèƒ«é“çº åŽ©æ—§é˜„é¸ é¹«é©¹ä¸¾æ®é”¯æƒ§å‰§è®µå±¦æ¦‰é£“é’œé””çª­é¾ƒé¹ƒç»¢é”©é•Œéš½è§‰å†³ç»è°²çé’§å†›éªçš²å¼€å‡¯å‰€åž²å¿¾æºé“ é”´é¾›é—¶é’ªé“é¢—å£³è¯¾éª’ç¼‚è½²é’¶é”žé¢”åž¦æ³é¾ˆé“¿æŠ åº“è£¤å–¾å—ä¾©éƒå“™è„å®½ç‹¯é«‹çŸ¿æ—·å†µè¯“è¯³é‚åœ¹çº©è´¶äºå²¿çª¥é¦ˆæºƒåŒ®è’‰æ„¦è©ç¯‘é˜ƒé”Ÿé²²æ‰©é˜”è›´èœ¡è…ŠèŽ±æ¥èµ–å´ƒå¾•æ¶žæ¿‘èµ‰çé“¼ç™žç±è“æ æ‹¦ç¯®é˜‘å…°æ¾œè°°æ½è§ˆæ‡’ç¼†çƒ‚æ»¥å²šæ¦„æ–“é•§è¤´ç…é˜†é”’æžåŠ³æ¶å” å´‚é“‘é“¹ç—¨ä¹é³“é•­åž’ç±»æ³ªè¯”ç¼§ç¯±ç‹¸ç¦»é²¤ç¤¼ä¸½åŽ‰åŠ±ç ¾åŽ†æ²¥éš¶ä¿ªéƒ¦åœè‹ˆèŽ…è“ å‘–é€¦éªŠç¼¡æž¥æ Žè½¹ç ºé”‚é¹‚ç– ç²è·žé›³é²¡é³¢ä¿©è”èŽ²è¿žé•°æ€œæ¶Ÿå¸˜æ•›è„¸é“¾æ‹ç‚¼ç»ƒè”¹å¥æ½‹çæ®“è£¢è££é²¢ç²®å‡‰ä¸¤è¾†è°…é­‰ç–—è¾½é•£ç¼­é’Œé¹©çŒŽä¸´é‚»é³žå‡›èµè”ºå»ªæª©è¾šèºé¾„é“ƒçµå²­é¢†ç»«æ£‚è›é²®é¦åˆ˜æµéªç»ºé•é¹¨é¾™è‹å’™ç¬¼åž„æ‹¢é™‡èŒæ³·ç‘æ Šèƒ§ç »æ¥¼å¨„æ‚ç¯“å»è’Œå–½åµé•‚ç˜˜è€§è¼é«…èŠ¦å¢é¢…åºç‚‰æŽ³å¤è™é²èµ‚ç¦„å½•é™†åž†æ’¸å™œé—¾æ³¸æ¸Œæ Œæ©¹è½³è¾‚è¾˜æ°‡èƒªé¸¬é¹­èˆ»é²ˆå³¦æŒ›å­ªæ»¦ä¹±è„”å¨ˆæ ¾é¸¾éŠ®æŠ¡è½®ä¼¦ä»‘æ²¦çº¶è®ºå›µèç½—é€»é”£ç®©éª¡éª†ç»œè¦çŒ¡æ³ºæ¤¤è„¶é•™é©´å•é“ä¾£å±¡ç¼•è™‘æ»¤ç»¿æ¦ˆè¤›é”Šå‘’å¦ˆçŽ›ç èš‚é©¬éª‚å—å”›å¬·æ©ä¹°éº¦å–è¿ˆè„‰åŠ¢çž’é¦’è›®æ»¡è°©ç¼¦é•˜é¢¡é³—çŒ«é”šé“†è´¸éº½æ²¡é•é—¨é—·ä»¬æ‰ªç„–æ‡‘é’”é”°æ¢¦çœ¯è°œå¼¥è§…å¹‚èŠˆè°§çŒ•ç¥¢ç»µç¼…æ¸‘è…¼é»¾åº™ç¼ˆç¼ªç­æ‚¯é—½é—µç¼—é¸£é“­è°¬è°Ÿè“¦é¦æ®é•†è°‹äº©é’¼å‘é’ çº³éš¾æŒ è„‘æ¼é—¹é“™è®·é¦å†…æ‹Ÿè…»é“Œé²µæ’µè¾‡é²¶é…¿é¸ŸèŒ‘è¢…è‚å•®é•Šé•é™§è˜–å—«é¢Ÿè¹‘æŸ ç‹žå®æ‹§æ³žè‹Žå’›èé’®çº½è„“æµ“å†œä¾¬å“é©½é’•è¯ºå‚©ç–Ÿæ¬§é¸¥æ®´å‘•æ²¤è®´æ€„ç“¯ç›˜è¹’åºžæŠ›ç–±èµ”è¾”å–·é¹çº°ç½´é“éª—è°éªˆé£˜ç¼¥é¢‘è´«å«”è‹¹å‡­è¯„æ³¼é¢‡é’‹æ‰‘é“ºæœ´è°±é•¤é•¨æ –è„é½éª‘å²‚å¯æ°”å¼ƒè®«è•²éªç»®æ¡¤ç¢›é¢€é¢ƒé³ç‰µé’Žé“…è¿ç­¾è°¦é’±é’³æ½œæµ…è°´å ‘ä½¥è¨æ‚­éªžç¼±æ¤ é’¤æžªå‘›å¢™è”·å¼ºæŠ¢å«±æ¨¯æˆ—ç‚é”–é”µé•ªç¾Ÿè·„é”¹æ¡¥ä¹”ä¾¨ç¿˜çªè¯®è°¯èžç¼²ç¡—è··çªƒæƒ¬é”²ç®§é’¦äº²å¯é”“è½»æ°¢å€¾é¡·è¯·åº†æ¿é²­ç¼ç©·èŒ•è›±å·¯èµ‡è™®é³…è¶‹åŒºèº¯é©±é¾‹è¯Žå²–é˜’è§‘é¸²é¢§æƒåŠè¯ ç»»è¾é“¨å´é¹Šç¡®é˜•é˜™æ‚«è®©é¥¶æ‰°ç»•è›å¨†æ¡¡çƒ­éŸ§è®¤çº«é¥ªè½«è£ç»’åµ˜è¾ç¼›é“·é¢¦è½¯é”èš¬é—°æ¶¦æ´’è¨é£’é³ƒèµ›ä¼žæ¯µç³ä¸§éªšæ‰«ç¼«æ¶©å•¬é“¯ç©‘æ€åˆ¹çº±é“©é²¨ç­›æ™’é…¾åˆ é—ªé™•èµ¡ç¼®è®ªå§—éªŸé’é³å¢’ä¼¤èµåž§æ®‡è§žçƒ§ç»èµŠæ‘„æ…‘è®¾åŽæ» ç•²ç»…å®¡å©¶è‚¾æ¸—è¯œè°‚æ¸–å£°ç»³èƒœå¸ˆç‹®æ¹¿è¯—æ—¶èš€å®žè¯†é©¶åŠ¿é€‚é‡Šé¥°è§†è¯•è°¥åŸ˜èŽ³å¼‘è½¼è´³é“ˆé²¥å¯¿å…½ç»¶æž¢è¾“ä¹¦èµŽå±žæœ¯æ ‘ç«–æ•°æ‘…çº¾å¸…é—©åŒè°ç¨Žé¡ºè¯´ç¡•çƒé“„ä¸é¥²åŽ®é©·ç¼Œé”¶é¸¶è€¸æ€‚é¢‚è®¼è¯µæ“žè–®é¦Šé£•é”¼è‹è¯‰è‚ƒè°¡ç¨£è™½éšç»¥å²è°‡å­™æŸç¬‹èªç‹²ç¼©çé”å”¢çƒç­æŒžé—¼é“Šé³Žå°æ€é’›é²æ‘Šè´ªç˜«æ»©å›è°­è°ˆå¹æ˜™é’½é”¬é¡¸æ±¤çƒ«å‚¥é¥§é“´é•—æ¶›ç»¦è®¨éŸ¬é“½è…¾èªŠé”‘é¢˜ä½“å±‰ç¼‡é¹ˆé˜—æ¡ç²œé¾†é²¦è´´é“åŽ…å¬çƒƒé“œç»Ÿæ¸å¤´é’­ç§ƒå›¾é’å›¢æŠŸé¢“èœ•é¥¨è„±é¸µé©®é©¼æ¤­ç®¨é¼è¢œå¨²è…½å¼¯æ¹¾é¡½ä¸‡çº¨ç»¾ç½‘è¾‹éŸ¦è¿å›´ä¸ºæ½ç»´è‹‡ä¼Ÿä¼ªçº¬è°“å«è¯¿å¸é—±æ²©æ¶ çŽ®éŸªç‚œé²”æ¸©é—»çº¹ç¨³é—®é˜Œç“®æŒèœ—æ¶¡çªå§èŽ´é¾Œå‘œé’¨ä¹Œè¯¬æ— èŠœå´åžé›¾åŠ¡è¯¯é‚¬åº‘æ€ƒå¦©éª›é¹‰é¹œé”¡ç‰ºè¢­ä¹ é“£æˆç»†é¥©é˜‹çŽºè§‹è™¾è¾–å³¡ä¾ ç‹­åŽ¦å“ç¡–é²œçº¤è´¤è¡”é—²æ˜¾é™©çŽ°çŒ®åŽ¿é¦…ç¾¡å®ªçº¿è‹‹èŽ¶è—“å²˜çŒƒå¨´é¹‡ç—«èšç±¼è·¹åŽ¢é•¶ä¹¡è¯¦å“é¡¹èŠ—é¥·éª§ç¼ƒé£¨è§åš£é”€æ™“å•¸å““æ½‡éªç»¡æž­ç®«åæŒŸæºèƒè°å†™æ³»è°¢äºµæ’·ç»ç¼¬é”Œè¡…å…´é™‰è¥å‡¶æ±¹é”ˆç»£é¦é¸ºè™šå˜˜é¡»è®¸å™ç»ªç»­è¯©é¡¼è½©æ‚¬é€‰ç™£ç»šè°–é“‰é•Ÿå­¦è°‘æ³¶é³•å‹‹è¯¢å¯»é©¯è®­è®¯é€ŠåŸ™æµ”é²ŸåŽ‹é¸¦é¸­å“‘äºšè®¶åž­å¨…æ¡ æ°©é˜‰çƒŸç›ä¸¥å²©é¢œé˜Žè‰³åŽŒç šå½¦è°šéªŒåŽ£èµä¿¨å…–è°³æ¹é—«é…½é­‡é¤é¼¹é¸¯æ¨æ‰¬ç–¡é˜³ç—’å…»æ ·ç‚€ç‘¶æ‘‡å°§é¥çª‘è°£è¯è½ºé¹žé³çˆ·é¡µä¸šå¶é¥è°’é‚ºæ™”çƒ¨åŒ»é“±é¢é—ä»ªèšè‰ºäº¿å¿†ä¹‰è¯£è®®è°Šè¯‘å¼‚ç»Žè¯’å‘“å³„é¥´æ€¿é©¿ç¼¢è½¶è´»é’‡é•’é•±ç˜—èˆ£è«é˜´é“¶é¥®éšé“Ÿç˜¾æ¨±å©´é¹°åº”ç¼¨èŽ¹è¤è¥è§è‡èµ¢é¢–èŒ”èŽºè¦è“¥æ’„å˜¤æ»¢æ½†ç’Žé¹¦ç˜¿é¢ç½‚å“Ÿæ‹¥ä½£ç—ˆè¸Šå’é•›ä¼˜å¿§é‚®é“€çŠ¹è¯±èŽ¸é“•é±¿èˆ†é±¼æ¸”å¨±ä¸Žå±¿è¯­ç‹±èª‰é¢„é©­ä¼›ä¿£è°€è°•è“£åµ›é¥«é˜ˆå¦ªçº¡è§Žæ¬¤é’°é¹†é¹¬é¾‰é¸³æ¸Šè¾•å›­å‘˜åœ†ç¼˜è¿œæ©¼é¸¢é¼‹çº¦è·ƒé’¥ç²¤æ‚¦é˜…é’ºéƒ§åŒ€é™¨è¿è•´é…æ™•éŸµéƒ“èŠ¸æ½æ„ çº­éŸ«æ®’æ°²æ‚ç¾è½½æ”’æš‚èµžç“’è¶±éŒ¾èµƒè„é©µå‡¿æž£è´£æ‹©åˆ™æ³½èµœå•§å¸»ç®¦è´¼è°®èµ ç»¼ç¼¯è½§é“¡é—¸æ …è¯ˆæ–‹å€ºæ¯¡ç›æ–©è¾—å´­æ ˆæˆ˜ç»½è°µå¼ æ¶¨å¸è´¦èƒ€èµµè¯é’Šè›°è¾™é”—è¿™è°ªè¾„é¹§è´žé’ˆä¾¦è¯Šé•‡é˜µæµˆç¼œæ¡¢è½¸èµˆç¥¯é¸©æŒ£çç‹°äº‰å¸§ç—‡éƒ‘è¯è¯¤å³¥é’²é“®ç­ç»‡èŒæ‰§çº¸æŒšæŽ·å¸œè´¨æ»žéª˜æ ‰æ €è½µè½¾è´½é¸·è›³çµ·è¸¬è¸¯è§¯é’Ÿç»ˆç§è‚¿ä¼—é”ºè¯Œè½´çš±æ˜¼éª¤çº£ç»‰çŒªè¯¸è¯›çƒ›çž©å˜±è´®é“¸é©»ä¼«æ§ é“¢ä¸“ç –è½¬èµšå•­é¦”é¢žæ¡©åº„è£…å¦†å£®çŠ¶é”¥èµ˜å ç¼€éª“ç¼’è°†å‡†ç€æµŠè¯¼é•¯å…¹èµ„æ¸è°˜ç¼è¾Žèµ€çœ¦é”±é¾‡é²»è¸ªæ€»çºµå¬é‚¹è¯¹é©ºé²°è¯…ç»„é•žé’»ç¼µèºœé³Ÿç¿±å¹¶åœæ²‰ä¸‘æ·€è¿­æ–—èŒƒå¹²çš‹ç¡…æŸœåŽä¼™ç§¸æ°è¯€å¤¸é‡Œå‡Œä¹ˆéœ‰æ»å‡„æ‰¦åœ£å°¸æŠ¬æ¶‚æ´¼å–‚æ±¡é”¨å’¸èŽå½æ¶Œæ¸¸åå¾¡æ„¿å²³äº‘ç¶æ‰Žæœ­ç­‘äºŽå¿—æ³¨å‡‹è® è°«éƒ„å‹å‡¼å‚åž…åž´åŸ¯åŸè‹˜è¬è®èŽœèŽ¼è°è—æ¸å’å£å’”å’å’´å™˜å™¼åš¯å¹žå²™åµ´å½·å¾¼çŠ¸ç‹é¦€é¦‡é¦“é¦•æ„£æ†·æ‡”ä¸¬æº†æ»Ÿæº·æ¼¤æ½´æ¾¹ç”¯çºŸç»”ç»±ç‰æž§æ¡Šæ¡‰æ§”æ©¥è½±è½·èµè‚·èƒ¨é£šç…³ç……ç†˜æ„æ·¼ç œç£™çœé’šé’·é“˜é“žé”ƒé”é”Žé”é”˜é”é”ªé”«é”¿é•…é•Žé•¢é•¥é•©é•²ç¨†é¹‹é¹›é¹±ç–¬ç–´ç—–ç™¯è£¥è¥è€¢é¢¥èž¨éº´é²…é²†é²‡é²žé²´é²ºé²¼é³Šé³‹é³˜é³™éž’éž´é½„';
        const tc = 'éŒ’çššè—¹ç¤™æ„›å™¯å¬¡ç’¦æ›–é„è«³éŠ¨éµªéª¯è¥–å¥§åª¼é©é°²å£©ç½·éˆ€æ“ºæ•—å”„é ’è¾¦çµ†éˆ‘å¹«ç¶éŽŠè¬—å‰é£½å¯¶å ±é®‘é´‡é½™è¼©è²é‹‡ç‹½å‚™æ†Šéµ¯è³éŒ›ç¹ƒç­†ç•¢æ–ƒå¹£é–‰è“½å—¶æ½·é‰ç¯³è¹•é‚Šç·¨è²¶è®Šè¾¯è¾®èŠç·¶ç±©æ¨™é©ƒé¢®é£†é¢é‘£é°¾é±‰åˆ¥ç™Ÿç€•æ¿±è³“æ“¯å„ç¹½æª³æ®¯è‡é‘Œé«•é¬¢é¤…ç¨Ÿæ’¥ç¼½é‰‘é§é¤‘éˆ¸éµ“è£œéˆ½è²¡åƒè ¶æ®˜æ…šæ…˜ç‡¦é©‚é»²è’¼è‰™å€‰æ»„å»å´å†Šæ¸¬æƒ»å±¤è©«é¤å„•é‡µæ”™æ‘»èŸ¬é¥žè®’çºéŸç”¢é—¡é¡«å›…è«‚è®–è•†æ‡ºå¬‹é©è¦˜ç¦ªé”å ´å˜—é•·å„Ÿè…¸å» æš¢å€€è‡æ‚µé–¶é¯§éˆ”è»Šå¾¹ç¡¨å¡µé™³è¥¯å‚–è«¶æ«¬ç££é½”æ’ç¨±æ‡²èª é¨æ£–æª‰é‹®éºç™¡é²é¦³æ¥é½’ç†¾é£­é´Ÿæ²–è¡èŸ²å¯µéŠƒç–‡èºŠç±Œç¶¢å„”å¹¬è®Žæ«¥å»šé‹¤é››ç¤Žå„²è§¸è™•èŠ»çµ€èº•å‚³é‡§ç˜¡é—–å‰µæ„´éŒ˜ç¶žç´”é¶‰ç¶½è¼Ÿé½ªè¾­è©žè³œé¶¿è°è”¥å›ªå¾žå¢è“¯é©„æ¨…æ¹Šè¼³èº¥ç«„æ”›éŒ¯éŠ¼é¹ºé”å™ éŸƒå¸¶è²¸é§˜ç´¿æ“”å–®é„²æ’£è†½æ†šèª•å½ˆæ®«è³§ç™‰ç°žç•¶æ“‹é»¨è•©æª”è®œç¢­è¥ æ—å³¶ç¦±å°Žç›œç‡¾ç‡ˆé„§é™æ•µæ»Œéžç· ç³´è©†è«¦ç¶ˆè¦¿é‘é¡›é»žå¢Šé›»å·”éˆ¿ç™²é‡£èª¿éŠšé¯›è«œç–Šé°ˆé‡˜é ‚éŒ è¨‚é‹Œä¸ŸéŠ©æ±å‹•æ£Ÿå‡å´ é¶‡ç«‡çŠ¢ç¨è®€è³­éç€†æ«ç‰˜ç¯¤é»·é›æ–·ç·žç±ªå…ŒéšŠå°æ‡Ÿé“å™¸é “éˆç‡‰èº‰å¥ªå¢®é¸éµé¡è¨›æƒ¡é¤“è«¤å Šé–¼è»›é‹¨é”é¶šé¡Žé¡“é±·èª’å…’çˆ¾é¤Œè²³é‚‡é‰ºé´¯é®žç™¼ç½°é–¥çºç¤¬é‡©ç…©è²©é£¯è¨ªç´¡éˆé­´é£›èª¹å»¢è²»ç·‹é¨é¯¡ç´›å¢³å¥®æ†¤ç³žåƒ¨è±æ¥“é‹’é¢¨ç˜‹é¦®ç¸«è«·é³³çƒè†šè¼»æ’«è¼”è³¦å¾©è² è¨ƒå©¦ç¸›é³§é§™ç´±ç´¼è³»éº©é®’é°’é‡“è©²éˆ£è“‹è³…æ¡¿è¶•ç¨ˆè´›å°·æŸç´ºå²¡å‰›é‹¼ç¶±å´—æˆ‡éŽ¬çªèª¥ç¸žé‹¯æ“±é´¿é–£é‰»å€‹ç´‡éŽ˜æ½çµ¦äº™è³¡ç¶†é¯é¾”å®®éžè²¢é‰¤æºèŒæ§‹è³¼å¤ è©¬ç·±è¦¯è ±é¡§è©è½‚éˆ·éŒ®é´£éµ é¶»å‰®æŽ›é´°æ‘‘é—œè§€é¤¨æ…£è²«è©¿æ‘œé¸›é°¥å»£ç·è¦æ­¸é¾œé–¨è»Œè©­è²´åŠŠåŒ­åŠŒåª¯æªœé®­é±–è¼¥æ»¾è¢žç·„é¯€é‹åœ‹éŽå å’¼å¹—æ§¨èŸˆé‰¿é§­éŸ“æ¼¢é—žçµŽé ¡è™Ÿçé¡¥é–¡é¶´è³€è¨¶é—”è £æ©«è½Ÿé´»ç´…é»Œè¨Œè‘’é–Žé±Ÿå£ºè­·æ»¬æˆ¶æ»¸é¶˜å˜©è¯ç•«åŠƒè©±é©Šæ¨ºéµæ‡·å£žæ­¡ç’°é‚„ç·©æ›å–šç˜“ç…¥æ¸™å¥ç¹¯é°é¯‡é»ƒè¬Šé°‰æ®è¼æ¯€è³„ç©¢æœƒç‡´åŒ¯è«±èª¨ç¹ªè©¼è–ˆå™¦æ¾®ç¹¢ç¿æš‰è‘·æ¸¾è«¢é¤›é–½ç²è²¨ç¦éˆ¥é‘Šæ“Šæ©Ÿç©é¥‘è·¡è­é›žç¸¾ç·æ¥µè¼¯ç´šæ“ å¹¾è–ŠåŠ‘æ¿Ÿè¨ˆè¨˜éš›ç¹¼ç´€è¨è©°è–ºå˜°åšŒé©¥ç’£è¦¬é½ç£¯ç¾ˆè †èº‹éœ½é±­é¯½å¤¾èŽ¢é °è³ˆé‰€åƒ¹é§•éƒŸæµ¹é‹éŽµèŸ¯æ®²ç›£å …ç®‹é–“è‰±ç·˜ç¹­æª¢å ¿é¹¼æ€æ’¿ç°¡å„‰æ¸›è–¦æª»é‘’è¸è³¤è¦‹éµè‰¦åŠé¤žæ¼¸æ¿ºæ¾—è««ç¸‘æˆ”æˆ©çž¼é¶¼ç­§é°¹éŸ‰å°‡æ¼¿è”£æ§³çŽè¬›é†¬çµ³éŸè† æ¾†é©•å¬Œæ”ªé‰¸çŸ¯åƒ¥è…³é¤ƒç¹³çµžè½Žè¼ƒæ’Ÿå¶ é·¦é®«éšŽç¯€æ½”çµèª¡å±†ç™¤é œé®šç·ŠéŒ¦åƒ…è¬¹é€²æ™‰ç‡¼ç›¡å‹èŠèŽ–å·¹è—Žé¥‰ç¸‰è´è¦²é¯¨é©šç¶“é ¸éœé¡å¾‘ç—™ç«¶å‡ˆå‰„æ¶‡é€•å¼³è„›éšç³¾å»„èˆŠé¬®é³©é·²é§’èˆ‰æ“šé‹¸æ‡¼åŠ‡è©Žå±¨æ«¸é¢¶é‰…é‹¦çª¶é½Ÿéµ‘çµ¹éŒˆé«é›‹è¦ºæ±ºçµ•è­ŽçŽ¨éˆžè»é§¿çš¸é–‹å‡±å‰´å¡æ„¾æ„·éŽ§é‡é¾•é–Œéˆ§éŠ¬é¡†æ®¼èª²é¨ç·™è»»éˆ³éŒé ·å¢¾æ‡‡é½¦é—æ‘³åº«è¤²åš³å¡Šå„ˆé„¶å™²è†¾å¯¬çªé«–ç¤¦æ› æ³èª†èª‘é„ºå£™çºŠè²ºè™§å·‹çªºé¥‹æ½°åŒ±è•¢æ†’èµç°£é–«éŒ•é¯¤æ“´é—Šè è Ÿè‡˜èŠä¾†è³´å´å¾ æ·¶ç€¨è³šçžéŒ¸ç™©ç±Ÿè—æ¬„æ””ç±ƒé—Œè˜­ç€¾è®•æ”¬è¦½æ‡¶çºœçˆ›æ¿«åµæ¬–æ–•é‘­è¥¤ç‘¯é–¬é‹ƒæ’ˆå‹žæ¾‡å˜®å¶—éŠ é’ç™†æ¨‚é°³é³å£˜é¡žæ·šèª„ç¸²ç±¬è²é›¢é¯‰ç¦®éº—åŽ²å‹µç¤«æ­·ç€éš¸å„·é…ˆå£¢è—¶è’žè˜ºåš¦é‚é©ªç¸­æ«ªæ«Ÿè½¢ç¤ªé‹°é¸ç™˜ç³²èº’é‚é±ºé±§å€†è¯è“®é€£é®æ†æ¼£ç°¾æ–‚è‡‰éˆæˆ€ç…‰ç·´è˜žå¥©ç€²ç’‰æ®®è¤³è¥é°±ç³§æ¶¼å…©è¼›è«’é­Žç™‚é¼éç¹šé‡•é·¯çµè‡¨é„°é±—å‡œè³ƒè—ºå»©æªè½”èºªé½¡éˆ´éˆå¶ºé ˜ç¶¾æ¬žèŸ¶é¯ªé¤¾åŠ‰ç€é¨®ç¶¹éŽ¦é·šé¾è¾åš¨ç± å£Ÿæ”éš´è˜¢ç€§ç“æ«³æœ§ç¤±æ¨“å©æ‘Ÿç°åƒ‚è”žå˜å¶é¤ç˜ºè€¬èž»é«è˜†ç›§é¡±å»¬çˆæ“„é¹µè™œé­¯è³‚ç¥¿éŒ„é™¸å£šæ“¼åš•é–­ç€˜æ·¥æ«¨æ«“è½¤è¼…è½†æ°Œè‡šé¸•é·ºè‰«é±¸å·’æ”£å­¿ç¤äº‚è‡ å­Œæ¬’é¸žé‘¾æŽ„è¼ªå€«ä¾–æ·ªç¶¸è«–åœ‡è˜¿ç¾…é‚é‘¼ç±®é¨¾é§±çµ¡çŠ–çŽ€æ¿¼æ¬è…¡éé©¢å‘‚é‹ä¾¶å±¢ç¸·æ…®æ¿¾ç¶ æ«šè¤¸é‹å˜¸åª½ç‘ªç¢¼èžžé¦¬ç½µå—Žå˜œå¬¤æ¦ªè²·éº¥è³£é‚è„ˆå‹±çžžé¥…è »æ»¿è¬¾ç¸µéé¡™é°»è²“éŒ¨é‰šè²¿éº¼æ²’éŽ‚é–€æ‚¶å€‘æ«ç‡œæ‡£é†éŒ³å¤¢çž‡è¬Žå½Œè¦“å†ªç¾‹è¬ç¼ç¦°ç¶¿ç·¬æ¾ é¦é»½å»Ÿç·²ç¹†æ»…æ†«é–©é–”ç·¡é³´éŠ˜è¬¬è¬¨é©€é¥ƒæ­¿éŒè¬€ç•é‰¬å¶éˆ‰ç´é›£æ’“è…¦æƒ±é¬§éƒè¨¥é¤’å…§æ“¬è†©éˆ®é¯¢æ”†è¼¦é¯°é‡€é³¥è”¦è£Šè¶åš™é‘·éŽ³éš‰è˜—å›é¡¢èº¡æª¸ç°å¯§æ“°æ¿˜è‹§åš€è¹éˆ•ç´è†¿æ¿ƒè¾²å„‚å™¥é§‘é‡¹è«¾å„ºç˜§æ­é·—æ¯†å˜”æ¼šè¬³æ…ªç”Œç›¤è¹£é¾æ‹‹çš°è³ è½¡å™´éµ¬ç´•ç¾†éˆ¹é¨™è«žé§¢é£„ç¸¹é »è²§å¬ªè˜‹æ†‘è©•æ½‘é —é‡™æ’²é‹ªæ¨¸è­œé·é æ£²è‡é½Šé¨Žè±ˆå•Ÿæ°£æ£„è¨–è˜„é¨ç¶ºæ¦¿ç£§é Žé é°­ç‰½é‡¬é‰›é·ç°½è¬™éŒ¢é‰—æ½›æ·ºè­´å¡¹åƒ‰è•æ…³é¨«ç¹¾æ§§éˆæ§å—†å¢»è–”å¼·æ¶å¬™æª£æˆ§ç†—éŒ†é˜é¹ç¾¥è¹Œé¬æ©‹å–¬åƒ‘ç¿¹ç«…èªšè­™è•Žç¹°ç£½è¹ºç«Šæ„œé¥ç¯‹æ¬½è¦ªå¯¢é‹Ÿè¼•æ°«å‚¾é ƒè«‹æ…¶æ’³é¯–ç“Šçª®ç…¢è›ºå·°è³•èŸ£é°è¶¨å€è»€é©…é½²è©˜å¶‡é—ƒè¦·é´é¡´æ¬Šå‹¸è©®ç¶£è¼‡éŠ“å»éµ²ç¢ºé—‹é—•æ„¨è®“é¥’æ“¾ç¹žè•˜å¬ˆæ©ˆç†±éŸŒèªç´‰é£ªè»”æ¦®çµ¨å¶¸è ‘ç¸ŸéŠ£é¡°è»ŸéŠ³èœ†é–æ½¤ç‘è–©é¢¯é°“è³½å‚˜æ¯¿ç³å–ªé¨·æŽƒç¹…æ¾€å—‡éŠ«ç©¡æ®ºå‰Žç´—éŽ©é¯Šç¯©æ›¬é‡ƒåˆªé–ƒé™œè´ç¹•è¨•å§é¨¸é‡¤é±”å¢‘å‚·è³žå°æ®¤è§´ç‡’ç´¹è³’æ”æ‡¾è¨­åŽ™ç„ç•¬ç´³å¯©å¬¸è…Žæ»²è©µè«—ç€‹è²ç¹©å‹å¸«ç…æ¿•è©©æ™‚è•å¯¦è­˜é§›å‹¢é©é‡‹é£¾è¦–è©¦è¬šå¡’è’”å¼’è»¾è²°éˆ°é°£å£½ç¸ç¶¬æ¨žè¼¸æ›¸è´–å±¬è¡“æ¨¹è±Žæ•¸æ”„ç´“å¸¥é–‚é›™èª°ç¨…é †èªªç¢©çˆé‘ çµ²é£¼å»é§Ÿç·¦é¶é·¥è³æ…«é Œè¨Ÿèª¦æ“»è—ªé¤¿é¢¼éŽªè˜‡è¨´è‚…è¬–ç©Œé›–éš¨ç¶æ­²èª¶å­«æç­è“€çŒ»ç¸®ç‘£éŽ–å—©è„§çºæ’»é—¥é‰ˆé°¨è‡ºæ…‹éˆ¦é®æ”¤è²ªç™±ç˜å£‡è­šè«‡å˜†æ›‡é‰­éŒŸé ‡æ¹¯ç‡™å„»é¤³é‹éœæ¿¤çµ³è¨ŽéŸœé‹±é¨°è¬„éŠ»é¡Œé«”å±œç·¹éµœé—æ¢ç³¶é½ é°·è²¼éµå»³è½çƒ´éŠ…çµ±æ…Ÿé ­éˆ„ç¦¿åœ–é‡·åœ˜æ‘¶é ¹è›»é£©è„«é´•é¦±é§æ©¢ç±œé¼‰è¥ªåª§è†ƒå½Žç£é ‘è¬ç´ˆç¶°ç¶²è¼žéŸ‹é•åœç‚ºæ¿°ç¶­è‘¦å‰å½ç·¯è¬‚è¡›è«‰å¹ƒé—ˆæºˆæ½¿ç‘‹éŸ™ç…’é®ªæº«èžç´‹ç©©å•é–¿ç”•æ’¾è¸æ¸¦çª©è‡¥èµé½·å—šéŽ¢çƒèª£ç„¡è•ªå³å¡¢éœ§å‹™èª¤é„”å»¡æ†®å«µé¨–éµ¡é¶©éŒ«çŠ§è¥²ç¿’éŠ‘æˆ²ç´°é¤¼é¬©ç’½è¦¡è¦è½„å³½ä¿ ç‹¹å»ˆåš‡ç¡¤é®®çº–è³¢éŠœé–‘é¡¯éšªç¾ç»ç¸£é¤¡ç¾¨æ†²ç·šèŽ§è–Ÿè˜šå³´ç«å«»é·´ç™‡è ”ç§ˆèºšå»‚é‘²é„‰è©³éŸ¿é …è–Œé¤‰é©¤ç·—é¥—è•­å›‚éŠ·æ›‰å˜¯å˜µç€Ÿé©ç¶ƒæ¢Ÿç°«å”æŒ¾æ”œè„…è«§å¯«ç€‰è¬è¤»æ“·ç´²çºˆé‹…é‡èˆˆé™˜æ»Žå…‡æ´¶éŠ¹ç¹¡é¥ˆéµ‚è™›å™“é ˆè¨±æ•˜ç·’çºŒè©¡é Šè»’æ‡¸é¸ç™¬çµ¢è«¼é‰‰é‡å­¸è¬”æ¾©é±ˆå‹›è©¢å°‹é¦´è¨“è¨Šéœå¡¤æ½¯é±˜å£“é´‰é´¨å•žäºžè¨åŸ¡å©­æ¤æ°¬é–¹ç…™é¹½åš´å·–é¡é–»è‰·åŽ­ç¡¯å½¥è«ºé©—åŽ´è´—å„¼å…—è®žæ‡¨é–†é‡…é­˜é¥œé¼´é´¦æ¥Šæšç˜é™½ç™¢é¤Šæ¨£ç…¬ç‘¤æ–å ¯é™çª¯è¬ è—¥è»ºé·‚é°©çˆºé æ¥­è‘‰é¨è¬é„´æ›„ç‡é†«éŠ¥é ¤éºå„€èŸ»è—å„„æ†¶ç¾©è©£è­°èª¼è­¯ç•°ç¹¹è©’å›ˆå¶§é£´æ‡Œé©›ç¸Šè»¼è²½é‡”éŽ°é¿ç˜žè‰¤è”­é™°éŠ€é£²éš±éŠ¦ç™®æ«»å¬°é·¹æ‡‰çº“ç‘©èž¢ç‡Ÿç†’è …è´ç©Žå¡‹é¶¯ç¸ˆéŽ£æ”–åš¶ç€…ç€ ç“”é¸šç™­é ¦ç½Œå–²æ“å‚­ç™°è¸´è© éžå„ªæ†‚éƒµéˆ¾çŒ¶èª˜è••éŠªé­·è¼¿é­šæ¼å¨›èˆ‡å¶¼èªžç„è­½é é¦­å‚´ä¿è«›è«­è•·å´³é£«é–¾å«—ç´†è¦¦æ­Ÿéˆºéµ’é·¸é½¬é´›æ·µè½…åœ’å“¡åœ“ç·£é æ«žé³¶é»¿ç´„èºé‘°ç²µæ‚…é–±é‰žé„–å‹»éš•é‹è˜Šé†žæšˆéŸ»é„†è•“æƒ²æ…ç´œéŸžæ®žæ°³é›œç½è¼‰æ”¢æš«è´Šç“šè¶²é¨è´“è‡Ÿé§”é‘¿æ£—è²¬æ“‡å‰‡æ¾¤è³¾å˜–å¹˜ç°€è³Šè­–è´ˆç¶œç¹’è»‹é˜é–˜æŸµè©é½‹å‚µæ°ˆç›žæ–¬è¼¾å¶„æ£§æˆ°ç¶»è­«å¼µæ¼²å¸³è³¬è„¹è¶™è©”é‡—èŸ„è½éºé€™è¬«è¼’é·“è²žé‡åµè¨ºéŽ®é™£æ¹žç¸æ¥¨è»«è³‘ç¦Žé´†æŽ™çœçŒ™çˆ­å¹€ç™¥é„­è­‰è«å´¢é‰¦éŒšç®ç¹”è·åŸ·ç´™æ‘¯æ“²å¹Ÿè³ªæ»¯é¨­æ«›æ¢”è»¹è¼Šè´„é·™èž„ç¸¶èº“èº‘è§¶é˜çµ‚ç¨®è…«çœ¾é¾è¬…è»¸çšºæ™é©Ÿç´‚ç¸è±¬è«¸èª…ç‡­çŸšå›‘è²¯é‘„é§ä½‡æ«§éŠ–å°ˆç£šè½‰è³ºå›€é¥Œé¡³æ¨èŽŠè£å¦å£¯ç‹€éŒè´…å¢œç¶´é¨…ç¸‹è«„æº–è‘—æ¿è«‘é²èŒ²è³‡æ¼¬è«®ç·‡è¼œè²²çœ¥éŒ™é½œé¯”è¹¤ç¸½ç¸±å‚¯é„’è«é¨¶é¯«è©›çµ„éƒé‰†çº˜èº¦é±’ç¿ºä¸¦è””æ²ˆé†œæ¾±å é¬¥ç¯„å¹¹è‡¯çŸ½æ«ƒå¾Œå¤¥ç¨­å‚‘è¨£èª‡è£æ·©éº½é»´æ’šæ·’æ‰¡è–å±æ“¡å¡—çªªé¤µæ±™éé¹¹è å½œæ¹§éŠç±²ç¦¦é¡˜å¶½é›²ç«ˆç´®åŠ„ç¯‰æ–¼èªŒè¨»é›•è¨è­¾éƒ¤çŒ›æ°¹é˜ªå£Ÿå –åžµå¢Šæª¾è•’è‘¤è“§è’“è‡æ§æ‘£å’¤å”šå“¢å™å™…æ’…åŠˆè¬”è¥†å¶´è„Šä»¿åƒ¥çéº…é¤˜é¤·é¥Šé¥¢æ¥žæ€µæ‡çˆ¿æ¼µç©æ··æ¿«ç€¦æ·¡å¯§ç³¸çµç·”ç‘‰æ¢˜æ£¬æ¡ˆæ©°æ««è»²è»¤è³«è†è…–é£ˆç³Šç…†æºœæ¹£æ¸ºç¢¸æ»¾çž˜éˆˆé‰•é‹£éŠ±é‹¥é‹¶é¦é§é©é€éƒéŒ‡éŽ„éŽ‡éŽ¿éé‘¥é‘¹é‘”ç©­é¶“é¶¥é¸Œç™§å±™ç˜‚è‡’è¥‡ç¹ˆè€®é¡¬èŸŽéº¯é®é®ƒé®Žé¯—é¯é¯´é±é¯¿é° é°µé±…éž½éŸé½‡';
        name = Array.from(name).map(c => sc[tc.indexOf(c.toString())] || c).join('');
        // 1. completely remove things inside () [], since they are all secondary; remove emojis; replace separators;
        name = name
            .replace(/ *\([^)]*\) */g, '') // remove things inside ()
            .replace(/ *\[[^)]*\] */g, '') // remive things inside []
            .replace(/ *ã€[^)]*ã€‘ */g, '') // remive things inside ã€ã€‘
            // eslint-disable-next-line max-len
            .replace(/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|\ud83c[\ude32-\ude3a]|\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g, '')
            .replace('ï¸', '') // (NOTE: 'ï¸' is NOT empty string of first!!! althought not visible, it has length 1)
            .replace('/', ' ') // same as separator
            .replace('-', ' ') // same as separator
            .replace(':', ' ') // same as separator
            .replace('#', ' ') // same as separator
            .replace('pcs', ' ') // same as separator
            .replace('b b-q', 'bbq')
            .replace('b.b.q', 'bbq')
            .replace('bar b-q', 'bbq')
            .replace('&', ' & ');
        name = name.split(' ').map(s => s.trim()).filter(s => s.length > 0).join(' ');
        // other frequent short names replacement!
        const dict = {
            veg: 'vegetable',
            vegs: 'vegetables',
            and: '&',
            w: 'with',
            'w.': 'with',
            'b.b.q': 'bbq',
            'barbecued': 'bbq'
        };
        name = name.split(' ').map(n => dict[n] || n).join(' ');
        // 2. tokenization due to language change
        // eg., Sesame ChickenèŠéº» é¸¡ å¤§ => Sesame Chicken|èŠéº»|é¸¡|å¤§
        // anytime there is a language switch, we insert a space
        name = Array.from(name).map((char, index, self) => {
            const lang = Object.keys(languageRegexMap).filter(key => languageRegexMap[key].test(char))[0] || 'EN'; // use EN to ignore other types
            const nextLang = index === self.length - 1 ? undefined : Object.keys(languageRegexMap).filter(key => languageRegexMap[key].test(self[index + 1]))[0] || 'EN'; // use EN to ignore other types
            if (lang !== nextLang && index < self.length - 1 && char !== ' ' && self[index + 1] !== ' ') {
                return `${char} `;
            }
            return char;
        }).join('');
        // 3. clean and trim each part of name to remove meaningless chars: emoji, useless, and numbers
        const nameParts = name.split(' ').map(part => {
            // trim off continuous bad characters from both start and end
            let cleaned = part.trim();
            // mixed number with at most one letter? we don't want them!
            if (/\d/.test(cleaned) && cleaned.length - cleaned.replace(/\D/g, '').length < 3) {
                cleaned = '';
            }
            // always test against longest word first, then single chars
            const uselessChars = ['æ™šé¤', 'åˆé¤', 'å¥—é¤', 'å¥—è£…', 'ç»„åˆé¤', 'å¤§ç›˜', 'å°ç›˜', 'ä¸­ç›˜', 'combo', ...Array.from('+.*/â€¢,)(-[]0123456789å¤§å°ä¸­æ™šåˆ\'')];
            // b. clean start
            // eslint-disable-next-line no-loop-func
            while (uselessChars.some(c => cleaned.startsWith(c))) {
                const matchedC = uselessChars.find(c => cleaned.startsWith(c));
                cleaned = cleaned.substring(matchedC.length);
            }
            // c. clean end
            // eslint-disable-next-line no-loop-func
            while (uselessChars.some(c => cleaned.endsWith(c))) {
                const matchedC = uselessChars.find(c => cleaned.endsWith(c));
                cleaned = cleaned.substring(0, cleaned.length - matchedC.length);
            }
            return cleaned;
        }).filter(p => p.length > 0);

        // 4. tag each part as EN or others, by detecting majority of chars of each part
        const taggedParts = [];
        nameParts.forEach(part => {
            const chars = Array.from(part);
            // å·¦å®—é¸¡general => å·¦å®—é¸¡ general => {å·¦å®—é¸¡, ZH} {general, EN}
            let language;
            let word;

            chars.forEach(char => {
                const lang = Object.keys(languageRegexMap).filter(key => languageRegexMap[key].test(char))[0] || 'EN';
                if (language !== lang) {
                    if (word !== undefined) {
                        taggedParts.push({ language, word });
                    }
                    language = lang;
                    word = char;
                } else {
                    word += `${char}`;
                }
            });
            taggedParts.push({ language, word });
        });
        // 5. construct language and alias, by detecting language change (group by language but keep same block)
        const aliasBlocks = []; // like {name: sesame chicken, language: EN}

        let language;
        let alias = '';
        taggedParts.forEach(tp => {
            if (tp.language !== language) {
                // add existing parsed block to list if there is one
                if (alias && language) {
                    aliasBlocks.push({ alias, language });
                }
                language = tp.language;
                alias = tp.word;
            } else {
                alias += ` ${tp.word}`;
            }
        });
        aliasBlocks.push({ alias, language });
        // 6. for asian words, space is useless
        aliasBlocks.forEach(ab => {
            if (['ZH', 'KO', 'JA'].indexOf(ab.language) >= 0) {
                ab.alias = ab.alias.split(' ').join('');
            }
        });
        // 7. forget about those super short ones!
        const results = aliasBlocks.filter(ab => (ab.alias.length > 3) || (ab.language !== 'EN' && ab.alias.length >= 2));
        return results;
    }

    // https://www.tutorialspoint.com/levenshtein-distance-in-javascript
    public static levenshteinDistance(str1 = '', str2 = '') {
        const track = Array(str2.length + 1).fill(null).map(() =>
            Array(str1.length + 1).fill(null));
        for (let i = 0; i <= str1.length; i += 1) {
            track[0][i] = i;
        }
        for (let j = 0; j <= str2.length; j += 1) {
            track[j][0] = j;
        }
        for (let j = 1; j <= str2.length; j += 1) {
            for (let i = 1; i <= str1.length; i += 1) {
                const indicator = str1[i - 1] === str2[j - 1] ? 0 : 1;
                track[j][i] = Math.min(
                    track[j][i - 1] + 1, // deletion
                    track[j - 1][i] + 1, // insertion
                    track[j - 1][i - 1] + indicator, // substitution
                );
            }
        }
        return track[str2.length][str1.length];
    };
}
