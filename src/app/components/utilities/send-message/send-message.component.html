<div>
  <label>Send to: </label>
  <input *ngIf="useCustomTarget" class="form-control" type="text" [(ngModel)]="phoneNumber">
  <ng-container *ngIf="!useCustomTarget">
    <div class="text-targets" *ngIf="channels.length > 0">
      <label *ngFor="let channel of sortedChannels">
        <input type="checkbox" (change)="selectTarget($event, channel)" [value]="channel.value"
          [checked]="targets.includes(channel)">
        <i class="fas fa-{{channelIcon(channel.type)}}"></i>
        {{channel.value}}
        <ng-container *ngIf="channel.notifications?.length">({{channel.notifications?.join("/")}})</ng-container>
      </label>
    </div>
    <div *ngIf="channels.length <= 0">
      No message target found, please add the contact you need to the RT's contacts.
    </div>
  </ng-container>
</div>
<div class="mt-3">
  <label>Message Template: </label>
  <div *ngIf="templateTypes.length > 1">
    <label class="mr-2" *ngFor="let type of templateTypes">
      <input type="radio" class="mr-1" (click)="changeTplType(type)" [checked]="type === templateType">{{type}}
    </label>
  </div>
  <select *ngIf="templates[templateType]" (change)="changeTpl($event)" class="form-control">
    <option *ngIf="!template?.title" hidden></option>
    <option *ngFor="let item of templates[templateType]" [value]="item.title"
      [selected]="item.title === template.title">
      {{item.title}}
    </option>
  </select>
  <div *ngIf="templateType !== 'Custom' && templates[templateType]?.length <= 0">
    No message template found, please contact to developer team if you need add new message templates.
  </div>
</div>
<div class="mt-3" *ngFor="let field of template?.inputs">
  <label>{{field.label}}: </label>
  <input class="form-control" type="{{field.type || 'text'}}" [(ngModel)]="field.value">
</div>
<ng-container *ngIf="hasSMS()">
  <div class="mt-3">
    <label>SMS Content:</label>
    <textarea [disabled]="!canEdit()" rows="10" class="form-control" [(ngModel)]="template.smsContent"></textarea>
  </div>
  <ng-container *ngIf="template.smsPreview">
    <div class="mt-3" *ngIf="smsContentMode === emailContentModes.Origin">
      <label>SMS HTML: <a (click)="smsContentMode = emailContentModes.Preview" class="btn-link">Preview</a></label>
      <textarea [disabled]="!canEdit()" rows="10" class="form-control" [(ngModel)]="template.smsPreview"></textarea>
    </div>
    <div class="mt-3" *ngIf="smsContentMode === emailContentModes.Preview">
      <label>SMS HTML: <a (click)="smsContentMode = emailContentModes.Origin" class="btn-link">Origin</a></label>
      <div class="msg-content" [innerHTML]="sanitized(template.smsPreview)"></div>
    </div>
  </ng-container>
</ng-container>

<ng-container *ngIf="hasEmail()">
  <div class="mt-3">
    <label>Email Subject:</label>
    <input [disabled]="!canEdit()" class="form-control" type="text" [(ngModel)]="template.subject">
  </div>
  <div class="mt-3" *ngIf="emailContentMode === emailContentModes.Origin">
    <label>Email Content: <a (click)="emailContentMode = emailContentModes.Preview" class="btn-link">Preview</a></label>
    <textarea [disabled]="!canEdit()" rows="10" class="form-control" [(ngModel)]="template.emailContent"></textarea>
  </div>
  <div class="mt-3" *ngIf="emailContentMode === emailContentModes.Preview">
    <label>Email Content: <a (click)="emailContentMode = emailContentModes.Origin" class="btn-link">Origin</a></label>
    <div class="msg-content" [innerHTML]="sanitized(template.emailContent)"></div>
  </div>
</ng-container>
<div class="mt-3">
  <button (click)="send()" [disabled]="!canSend()" class="btn btn-primary btn-block">Send</button>
</div>
