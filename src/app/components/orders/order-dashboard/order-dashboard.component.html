<h1 class="text-center">Orders in Past 24 Hours</h1>
<div class="text-right mb-2">
  <div class="pb-2">
    <button class="btn btn-primary" (click)="refresh()">
      <i class="fas fa-sync"></i> refresh</button>
    <button class="btn btn-primary" (click)="downloadStats()">
      <i class="fas fa-chart-line"></i> Download Stats</button>
  </div>
</div>
<div class="text-right">
  Total Orders:
  <span class="badge badge-info">{{totalOrders}}</span>
  Restaurant Having Orders:
  <span class="badge badge-success">{{restaurantsWithOrders}}</span>
  No Orders:
  <span class="badge badge-warning">{{restaurantsWithoutOrders}}</span>

</div>
<table class="table">
  <thead>
    <tr>
      <!-- <th scope="col">Agent</th> -->
      <th>Restaurant</th>
      <th>Total</th>
      <th>Change</th>
      <th class="text-center">GMB Owner</th>
      <th class="text-center">Website</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let row of rows;">
      <!-- <td>
        {{row.restaurant.rateSchedules && row.restaurant.rateSchedules.length > 0 ? row.restaurant.rateSchedules[0].agent : ''}}
      </td> -->
      <td>
        <span (click)="row.expanded = !row.expanded"></span>
        <a href="{{getGoogleQuery(row)}}" target="_blank">{{row.restaurant.name}}
        </a>
        <button *ngIf="row.orders.length > 0" class="btn btn-link py-0" (click)="row.expanded = !row.expanded">
          <i class="fas {{row.expanded ? 'fa-caret-up' : 'fa-caret-down'}} "></i>
        </button>

        <div *ngIf="row.expanded">
          <ng-container *ngFor="let order of row.orders">
            <a href="https://biz.qmenu.us/#/order/{{order._id}}" target="_blank">
              <span class="badge badge-info">{{order.orderNumber}}</span>
            </a>
          </ng-container>
        </div>
      </td>
      <td>{{row.orders.length}}</td>
      <td>
        <span *ngIf="row.orders.length > row.yesterdayOrders.length" class="text-success">+{{row.orders.length -
          row.yesterdayOrders.length}}</span>
        <span *ngIf="row.orders.length === row.yesterdayOrders.length">-</span>
        <span *ngIf="row.orders.length < row.yesterdayOrders.length" class="text-danger">{{row.orders.length -
          row.yesterdayOrders.length}}</span>
      </td>
      <td class="text-center">
        <img *ngIf="row.gmbBiz.published" [attr.src]="'/assets/images/qmenu.png'" alt="qmenu" height="16px">
        <img *ngIf="row.gmbBiz.suspended" [attr.src]="'/assets/images/qmenu-gray.png'" alt="qmenu" height="16px">

      </td>
      <td class="text-center">
        <a href="{{row.gmbBiz.gmbWebsite}}" title="{{row.gmbBiz.gmbWebsite}}" target="_blank">
          <i *ngIf="!getLogo(row.gmbBiz) && row.gmbBiz.gmbOwner" class="fas fa-question text-danger"></i>
          <img *ngIf="getLogo(row.gmbBiz)" [attr.src]="'/assets/images/' + getLogo(row.gmbBiz)" [attr.alt]="row.gmbBiz.gmbOwner"
            height="16px">
          <i class="fas fa-lock-open text-info" *ngIf="row.gmbBiz.gmbOpen"></i>
        </a>
      </td>
    </tr>
  </tbody>
</table>