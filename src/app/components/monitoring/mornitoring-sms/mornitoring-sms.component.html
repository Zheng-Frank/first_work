<div class="card">
  <h2 class="card-title m-3">
    <h1 class="text-center">SMS Problems ({{filteredRows.length}})</h1>
  </h2>
  <div class="card-body">
    <div class="form-inline">
      <!-- start with to filter -->
      <select class="form-control my-2 mx-2" [(ngModel)]="toOption" (change)="filterRows()">
        <option *ngFor="let option of toOptions"> {{option}} </option>
      </select>
      <!-- end with to filter -->
      <!-- start with search input -->
      <input [qDebounce]="500" (debounce)="debounce($event)" type="text" class="form-control my-2 mx-2 search-input"
        placeholder="RT name or RT ID" [(ngModel)]="searchFilter">
      <!-- end with search input -->
      <!-- start with provider -->
      <select class="form-control my-2 mx-2" [(ngModel)]="providerOption" (change)="filterRows()">
        <option *ngFor="let option of providerOptions"> {{option}} </option>
      </select>
      <!-- end with provider -->
      <!-- start with pagination -->
      <input class="form-check-input" type="checkbox" [(ngModel)]="pagination">
      <label class="form-check-label mr-5">
        Pagination
      </label>
      <!-- end with pagination -->
    </div>
    <div class="row mx-1">
      <button type="button" class="btn btn-link" (click)="toggleShowAdvancedSearch()">
        {{ showAdvancedSearch?'Hide advanced search..':'Show advanced search..'}}</button>
    </div>
    <div class="form-inline mx-2" *ngIf="showAdvancedSearch">
      <!-- start with happened -->
      <select class="form-control my-2 mx-2" [(ngModel)]="happenedOption">
        <option *ngFor="let option of happenedOptions"> {{option}} </option>
      </select>
      <!-- end with happened -->
      <!-- start with custom date -->
      <ng-container *ngIf="happenedOption === happenedTypes.Custom_Range">
        <label class="ml-2">From:</label>
        <input class="form-control ml-1" type="date" [(ngModel)]="fromDate">
        <label class="ml-2">To:</label>
        <input class="form-control ml-1" type="date" [(ngModel)]="toDate">
      </ng-container>
      <button class="btn btn-primary ml-2" (click)="populateSMSProblems()">Search</button>
      <!-- end with custom date -->
    </div>

    <q-table [rows]="filteredRows" [tableColumnDescriptors]="myColumnDescriptors" [compact]="true"
      [pageSize]="pagination ? 100 : 100000">
      <tr *tableRowTemplate="let row;">
        <td>
          <i class="fa fa-{{getTypeIcon(row.type.text)}}"></i>
          <div *ngIf="row.type.rtInfo">
            <a target="_blank" href="#/restaurants/{{row.type.rtInfo?._id}}">{{row.type.rtInfo?.name}}</a>
            <div><small>{{row.type.rtInfo?._id}}</small></div>
          </div>
        </td>
        <td>
          {{row.fromNumber}}
        </td>
        <td>
          {{row.toNumber}}
        </td>
        <td>
          {{row.createdAt | date:'yyyy-MM-dd HH:MM:SS'}}
        </td>
        <td>
          {{row.provider}}
        </td>
        <td>
          {{row.currentProvider}}
        </td>
        <td>
          {{row.error}}
        </td>
      </tr>
    </q-table>
  </div>
</div>
