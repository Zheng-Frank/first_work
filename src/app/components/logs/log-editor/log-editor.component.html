<div *ngIf="!restaurant">
  <label>Select Restaurant:</label>
  <q-restaurant-picker #myRestaurantPicker [restaurants]="restaurantList" (select)="select($event)">
  </q-restaurant-picker>
</div>

<div class="clearfix alert alert-info" *ngIf="restaurant">
  <div class="media float-left">
    <q-restaurant-media-object [restaurant]="restaurant"></q-restaurant-media-object>
  </div>
  <div class="float-right">
    <button class="btn btn-link" (click)="resetRestaurant()">Reset</button>
  </div>
</div>

<q-form-builder [object]="log" [showDelete]="log.time && isAdmin()" [fieldDescriptors]="logFieldDescriptors"
  (submit)="submit($event)" (cancel)="clickCancel()" (remove)="clickRemove($event)">

  <div class="mb-3">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="id-pin" [checked]="log.type === 'google-pin'"
        (change)="toggleIsGooglePIN()">
      <label class="form-check-label" for="id-pin"> Google PIN</label>
    </div>
  </div>

  <div class="mb-3">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="id-adjustment" [(ngModel)]="hasAdjustment"
        (change)="changeHasAdjustment()">
      <label class="form-check-label" for="id-adjustment"> Credit or Debit Adjustment</label>
    </div>
  </div>

  <div class="card border-info mb-3" *qIf="hasAdjustment">
    <div class="card-header">
      <i class="fas fa-exclamation"></i> DO NOT ADJUST CUSTOMER AND RESTAURANT AGREED ORDER CHANGES HERE. Only input
      qMenu and restaurant mutually agreed
      adjustment here. The adjustment will be included in next invoice cycle.
      <div>
        <strong>* STOP IF YOU DO NOT FULLY UNDERSTAND THIS FORM.</strong>
      </div>
    </div>
    <div class="card-body">

      <div class="mb-3">
        <label for="id-amount">Credit to Restaurant($)</label>
        <div class="text-danger">
          <small>NOTE: Input a negative number if it is a debit (money deducted from restaurant)</small>
        </div>
        <input class="form-control" type="number" id="id-amount" [(ngModel)]="log.adjustmentAmount">
      </div>

      <div class="mb-3">
        <label for="id-reason">Reason (a clear description)
        </label>
        <input class="form-control" type="text" id="id-reason" [(ngModel)]="log.adjustmentReason">
      </div>
      <div class="mb-3">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="id-transaction-adjustment"
            [checked]="log.adjustmentType === 'TRANSACTION'" (change)="toggleAdjustmentType()">
          <label class="form-check-label" for="id-transaction-adjustment"> Stripe Dispute</label>
        </div>
      </div>
    </div>
  </div>

  <div class="mb-3">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="id-debt" [checked]="log.type === 'collection'"
        (change)="toggleIsCollection()">
      <label class="form-check-label" for="id-debt"> Invoice Debt Collection</label>
    </div>
  </div>


  <!-- Create New Task Option -->
  <div class="mb-3">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="id-delegate" [(ngModel)]="hasTask" (change)="changeHasTask()">
      <label class="form-check-label" for="id-delegate"> Delegate to Task</label>
    </div>
  </div>

  <div class="card border-info p-3" *qIf="hasTask">
    <div class="card-header my-2">
      <i class="fas fa-exclamation"></i> Write down any comments in Response field and the text in Reponse field will
      be copied to task comments.
      <div>
        <strong>* Select a task template below:</strong>
      </div>
    </div>
    <select class="form-control mr-4" [(ngModel)]="selectedTaskTemplate" (change)="selectTemplate($event)">
      <option></option>
      <option *ngFor="let t of predefinedTasks" [ngValue]="t">{{t.name}}</option>
    </select>

    <div class="form-group alert alert-warning">
      <label>Assign to:</label>
      <select class="form-control mr-4" [(ngModel)]="assignee">
        <option></option>
        <option *ngFor="let a of assigneeList" [ngValue]="a.username">{{a.username}}</option>
      </select>
    </div>
  </div>

  <div class="mb-3">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="id-task" [checked]="log.type === 'force-qmenu-collect'"
        (change)="toggleForceQmenuCollect()">
      <label class="form-check-label" for="id-task"> Force qMenu Collect</label>
    </div>
  </div>

  <div class="mb-3">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="id-gmb-calls" [checked]="log.type === 'gmb-call'"
        [(ngModel)]="hasGMBCall" (change)="toggleGMBCalls()">
      <label class="form-check-label" for="id-gmb-calls"> GMB Calls</label>
    </div>
  </div>
  <div class="mb-3">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="id-hours-of-operation"
        [checked]="log.type === 'hours-of-operation'" (change)='toggleHoursOfOperation()'>
      <label class="form-check-label" for="id-hours-of-operation">Hours Of Operation</label>
    </div>
  </div>

  <div class="card border-info p-3 mb-2" *qIf="hasGMBCall">

    <div class="form-group mb-2">
      <label>Agree to Cooperate (同意分享验证码)</label>
      <q-simple-radio [(ngModel)]="agreeToCorporate" [equalWidth]="true" [values]="['Yes', 'No']"
        (ngModelChange)="handleUpdate()">
      </q-simple-radio>
    </div>

    <div class="form-group mb-2">
      <label>qMenu Exclusive (同意不给别家验证码)</label>
      <q-simple-radio [(ngModel)]="qmenuExclusive" [equalWidth]="true" [values]="['Yes', 'No']"
        (ngModelChange)="handleUpdate()">
      </q-simple-radio>
    </div>

  </div>

  <div class="mb-3" *ngIf="!hasAdjustment && !hasTask">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="id-resolved" [(ngModel)]="log.resolved">
      <label class="form-check-label" for="id-resolved"> Resolved</label>
    </div>
  </div>

  <h6 class="text-danger mb-3" style="cursor: pointer" (click)="showSpecialized = !showSpecialized">
    {{!showSpecialized ? 'Show' : 'Hide'}} Specialized...</h6>
  <div *qIf="showSpecialized">
    <div class="mb-3 ml-3">
      <div class="form-check">
        <input class="form-check-input" type="checkbox" id="id-qr-dine-in" [checked]="log.type === 'qr-dine-in'"
          (change)='toggleQRDineIn()'>
        <label class="form-check-label" for="id-qr-dine-in">QR Dine-In</label>
      </div>
    </div>
    <div class="mb-3 ml-3">
      <div class="form-check">
        <input class="form-check-input" type="checkbox" id="id-weird-data-cleanup"
          [checked]="log.type === 'weird-data-cleanup'" (change)='toggleWeirdDataCleanUp()'>
        <label class="form-check-label" for="id-weird-data-cleanup">Weird Data Cleanup</label>
      </div>
    </div>
    <div class="mb-3 ml-3">
      <div class="form-check">
        <input class="form-check-input" type="checkbox" id="id-cleanup-insisted"
          [checked]="log.type === 'cleanup-insisted'" (change)='toggleInsistedLink()'>
        <label class="form-check-label" for="id-cleanup-insisted">Insisted Link Cleanup</label>
      </div>
    </div>
    <div class="mb-3 ml-3">
      <div class="form-check">
        <input class="form-check-input" type="checkbox" id="id-vip-follow-up"
          [checked]="log.type === 'vip-follow-up'" (change)='toggleVIPFollowup()'>
        <label class="form-check-label" for="id-vip-follow-up">VIP Followup</label>
      </div>
    </div>
    <!-- start with menu setup -->
    <div class="mb-3 ml-3">
      <div class="form-check">
        <input class="form-check-input" type="checkbox" id="id-menu-setup"
          [checked]="log.type === 'menu-setup'" (change)='toggleMenuSetup()'>
        <label class="form-check-label" for="id-menu-setup">Menu Setup</label>
      </div>
    </div>
    <!-- end with menu setup -->
    <!-- start with payment-pickup-setup -->
    <div class="mb-3 ml-3">
      <div class="form-check">
        <input class="form-check-input" type="checkbox" id="id-payment-pickup-setup"
          [checked]="log.type === 'payment-pickup-setup'" (change)='togglePaymentPickup()'>
        <label class="form-check-label" for="id-payment-pickup-setup">Payment (Pickup order)</label>
      </div>
    </div>
    <!-- end with payment-pickup-setup -->
    <!-- start with payment-delivery-setup -->
    <div class="mb-3 ml-3">
      <div class="form-check">
        <input class="form-check-input" type="checkbox" id="id-payment-delivery-setup"
          [checked]="log.type === 'payment-delivery-setup'" (change)='togglePaymentDelivery()'>
        <label class="form-check-label" for="id-payment-delivery-setup">Payment (Delivery order)</label>
      </div>
    </div>
    <!-- end with payment-delivery-setup -->
  </div>
</q-form-builder>
