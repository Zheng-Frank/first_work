<div class="card mb-2">
  <h3 class="card-title text-center pt-4 pb-2">
    <i class="far fa-building"></i> Profile</h3>
  <ul class="list-group list-group-flush">
    <li class="list-group-item">

      <div *qIf="!editing">
        <table class="table table-borderless table-sm">
          <tbody>
            <!-- Basic Information -->
            <tr>
              <th colspan="2" class="text-left" style="font-weight:bond;font-size:1.2rem;">Basic Information</th>
            </tr>
            <tr>
              <th class="text-left pl-5">Name</th>
              <td class="pl-1">{{restaurant.name}} ({{getMongoDate(restaurant._id) | date: 'shortDate'}})
              </td>
            </tr>
            <tr>
              <th class="text-left pl-5">Address</th>
              <td class="pl-1">{{restaurant.googleAddress?.formatted_address}}</td>
            </tr>
            <tr>
              <th class="text-left pl-5">Address Extra</th>
              <td class="pl-1">{{restaurant.googleAddress?.apt}}</td>
            </tr>
            <tr>
              <th class="text-left pl-5">ID</th>
              <td class="pl-1">{{restaurant._id}}</td>
            </tr>
            <tr>
              <th class="text-left pl-5">Restaurant ID</th>
              <td class="pl-1">{{restaurant.restaurantId}}</td>
            </tr>
            <tr>
              <th class="text-left pl-5">Alias</th>
              <td class="pl-1">{{restaurant.alias}}</td>
            </tr>
            <tr>
              <th class="text-left pl-5">Time Zone</th>
              <td class="pl-1">
                {{restaurant.googleAddress.timezone}}({{_timezone.getOffsetNumber(restaurant.googleAddress.timezone)}})
              </td>
            </tr>
            <tr>
              <th class="text-left pl-5">Tax Rate</th>
              <td class="pl-1">{{restaurant.taxRate | percentage}}</td>
            </tr>
            <tr>
              <th class="text-left pl-5">Sales Agent</th>
              <td class="pl-1">{{(restaurant.rateSchedules || [])[0]?.agent || 'N/A'}}</td>
            </tr>
            <tr>
              <th class="text-left pl-5">Disabled</th>
              <td class="pl-1">{{!!restaurant.disabled}}</td>
            </tr>
            <!--Preferences -->
            <tr>
              <th colspan="2" class="text-left" style="font-weight:bond;font-size:1.2rem;">Preferences</th>
            </tr>
            <tr>
              <th class="text-left pl-5">Preferred Language</th>
              <td class="pl-1">{{restaurant.preferredLanguage}}</td>
            </tr>
            <tr>
              <th class="text-left pl-5">Website Broadcast</th>
              <td class="pl-1">{{restaurant.notification || 'N/A'}}</td>
            </tr>
            <!-- Fee/Minimum Settings -->
            <tr>
              <th colspan="2" class="text-left" style="font-weight:bond;font-size:1.2rem;">Fee/Minimum Settings</th>
            </tr>
            <ng-container *ngIf="!restaurant.feeSchedules">
              <tr>
                <th class="text-left pl-5">Surcharge</th>
                <td class="pl-1">{{restaurant.surchargeName || 'surcharge'}}
                  {{restaurant.surchargeRate ? (restaurant.surchargeRate*100).toFixed(2)+'%' : ''}}
                  {{restaurant.surchargeRate ? '+': '' }}{{restaurant.surchargeAmount ? '$'+restaurant.surchargeAmount.toFixed(2) : ''}}
                </td>
              </tr>
              <tr>
                <th class="text-left pl-5">Surcharge Rate</th>
                <td class="pl-1">{{restaurant.surchargeRate | percentage}}</td>
              </tr>
              <tr>
                <th class="text-left pl-5">CC Processing Rate</th>
                <td class="pl-1">{{restaurant.ccProcessingRate | percentage}}</td>
              </tr>
              <tr>
                <th class="text-left pl-5">CC Processing Flat Fee</th>
                <td class="pl-1">{{restaurant.ccProcessingFlatFee | currency:'USD':'symbol'}}</td>

              </tr>
            </ng-container>
            <tr>
              <th class="text-left pl-5">Pickup Minimum</th>
              <td class="pl-1">{{restaurant.pickupMinimum | money}}</td>
            </tr>
            <tr>
              <th class="text-left pl-5">CC Minimum Charge</th>
              <td class="pl-1">{{restaurant.ccMinimumCharge | money}}</td>
            </tr>
            <tr>
              <th class="text-left pl-5">Time Estimate for Pickup</th>
              <td class="pl-1">{{restaurant.pickupTimeEstimate || 'N/A'}} minutes</td>
            </tr>
            <tr>
              <th class="text-left pl-5">Time Estimate for Delivery</th>
              <td class="pl-1">{{restaurant.deliveryTimeEstimate || 'N/A'}} minutes</td>
            </tr>
            <!-- Other Preferences -->
            <tr>
              <th colspan="2" class="text-left" style="font-weight:bond;font-size:1.2rem;">Other Preferences </th>
            </tr>
            <tr>
              <th class="text-left pl-5">Disable Scheduling</th>
              <td class="pl-1">{{!!restaurant.disableScheduling}}</td>
            </tr>
            
            <tr>
              <th class="text-left pl-5">Notes</th>
              <td class="pl-1" style="white-space: pre-wrap">{{restaurant.notes}}</td>
            </tr>
            <tr>
              <button class="btn btn-link" (click)="showDetails = !showDetails">{{showDetails ? 'Hide details' : 'More
								details...'}}
              </button>
              <div *qIf="showDetails">
                <ul class="list-group list-group-flush">
                  <li class="list-group-item">
                    <table class="table table-borderless table-sm">
                      <tbody>
                        <tr>
                          <th class="text-left">Hide Order Status on Customer Side</th>
                          <td class="pl-1">{{!!restaurant.hideOrderStatus}}</td>
                        </tr>
                        <tr>
                          <th class="text-left">Skip Order Confirmation</th>
                          <td class="pl-1">{{!!restaurant.skipOrderConfirmation}}</td>
                        </tr>
                        <tr>
                          <th class="text-left">Skip Auto Invoicing</th>
                          <td class="pl-1">{{!!restaurant.skipAutoInvoicing}}</td>
                        </tr>
                        <tr>
                          <th class="text-left">Not Show Tax Option to Customer</th>
                          <td class="pl-1">{{!!restaurant.skipShowTax}}</td>
                        </tr>
                        <tr>
                          <th class="text-left">Skip Image Inject</th>
                          <td class="pl-1">{{!!restaurant.skipImageInjection}}</td>
                        </tr>
                        <tr>
                          <th class="text-left">Allow submitting order at close time</th>
                          <td class="pl-1">{{!!restaurant.menuHoursExtended}}</td>
                        </tr>
                        <tr>
                          <th class="text-left">Hide printing CC</th>
                          <td class="pl-1">{{!!restaurant.hidePrintingCCInfo}}</td>
                        </tr>
                        <tr>
                          <th class="text-left">Hide Tip Input</th>
                          <td class="pl-1">{{!!restaurant.hideTipInput}}</td>
                        </tr>
                      </tbody>
                    </table>
                  </li>
                </ul>

              </div>
            </tr>
          </tbody>
        </table>
      </div>


      <!--editing view-->
      <div *qIf="editing">
        <!-- Basic Information -->
        <div class="form-group row ml-2">
          <h4>Basic Information
            <button class="btn btn-link" (click)="ifShowBasicInformation=!ifShowBasicInformation">
              <i class="fa fa-angle-right" *ngIf="!ifShowBasicInformation"></i>
              <i class="fa fa-angle-down" *ngIf="ifShowBasicInformation"></i>
            </button>
          </h4>
        </div>
        <ng-container *ngIf="ifShowBasicInformation">
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Name</label>
            <div class="col-7 text-left">
              <input type="text" [(ngModel)]="name" class="form-control">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Address</label>
            <div class="col-7 text-left">
              <q-address-picker [address]="address" (pick)="selectAddress($event)"></q-address-picker>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Address Extra</label>
            <div class="col-7 text-left">
              <input type="text" class="form-control" placeholder="eg. Suite 300" [(ngModel)]="apt">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Tax Rate</label>
            <div class="col-7 text-left">
              <input type="number" [(ngModel)]="taxRate" class="form-control">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Sales Agent</label>
            <div class="col-7 text-left">
              <input type="text" [(ngModel)]="salesAgent" class="form-control">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Domain</label>
            <div class="col-7 text-left">
              <input type="text" [(ngModel)]="domain" class="form-control" placeholder="domain name, eg. qmenutest.com">
            </div>
          </div>
          <div *ngIf="isDisabledEditable()">
            <label class="col-4 col-form-label pt-0 pl-5">Disabled</label>
            <div class="pl-1 col-7">
              <div class="d-flex flex-column">
                <input type="checkbox" [(ngModel)]="disabled" (ngModelChange)="disabledHandle()">
                <div *ngIf="disabled" class="mt-3">
                  <div>
                    <small class="font-weight-bold">Disable it temporarily?</small>
                    <q-simple-radio [(ngModel)]="isTemporarilyDisabled" [equalWidth]="true" [values]="['Yes', 'No']"
                      (ngModelChange)="disabledHandle()"></q-simple-radio>
                    <div *ngIf="isTemporarilyDisabled === 'Yes'">
                      <small class="font-weight-bold">Comeback Date</small>
                      <input type="date" class="form-control" [(ngModel)]="comebackDate" [min]="now">
                      <div class="d-flex justify-content-end">
                        <small *ngIf="isComebackDateCorrectlySet" class="text-success mt-1">Done</small>
                        <button *ngIf="!isComebackDateCorrectlySet" class="btn btn-link m-0 p-0"
                          (click)="setComebackDateAsUnknown()"><small>Set as unknown date</small></button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ng-container>
        <!--Preferences -->
        <div class="form-group row ml-2">
          <h4>Preferences
            <button class="btn btn-link" (click)="ifShowPreferences=!ifShowPreferences">
              <i class="fa fa-angle-right" *ngIf="!ifShowPreferences"></i>
              <i class="fa fa-angle-down" *ngIf="ifShowPreferences"></i>
            </button>
          </h4>
        </div>
        <ng-container *ngIf="ifShowPreferences">
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Time Estimate for Pickup (mins)</label>
            <div class="col-7 text-left">
              <input type="number" [(ngModel)]="pickupTimeEstimate" class="form-control">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Time Estimate for Delivery (mins)</label>
            <div class="col-7 text-left">
              <input type="number" [(ngModel)]="deliveryTimeEstimate" class="form-control">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Disable Ordering Ahead</label>
            <div class="col-7 text-left">
              <input type="checkbox" [(ngModel)]="disableScheduling">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Order Call Language</label>
            <div class="col-7 text-left">
              <select class="form-control" [(ngModel)]="preferredLanguage">
                <option *ngFor="let language of preferredLanguages" [ngValue]="language">
                  {{ language.text }}
                </option>
              </select>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Website Broadcast</label>
            <div class="col-7 text-left">
              <input type="text" [(ngModel)]="notification" class="form-control"
                placeholder="important message showing on website">
            </div>
          </div>

          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Logo</label>
            <div class="pl-1 col-7">
              <hr>
              <div *ngIf="logo" class="pr-1 pb-1" style="display:inline-block; position:relative">
                <img class="img-thumbnail app-thumbnail-h-6" src="{{logo}}">
                <button (click)="deleteLogo(img)" class="btn btn-secondary close-button transparent">
                  <i class="fas fa-times"></i>
                </button>
                <button (click)="deleteLogo(img)" class="btn btn-link close-button text-danger">
                  <i class="fas fa-times"></i>
                </button>
              </div>
              <div *ngIf="uploadLogoError">
                <span class="text-danger">{{uploadLogoError}}</span>
              </div>
              <div class="app-limit-file">
                <input type="file" (change)="onUploadLogo($event)" />
              </div>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Photos</label>
            <div class="col-7 text-left">
              <div *ngFor="let img of images" class="pr-1 pb-1" style="display:inline-block; position:relative">
                <img class="img-thumbnail app-thumbnail-h-6" src="{{img}}">
                <button (click)="deleteImage(img)" class="btn btn-secondary close-button transparent">
                  <i class="fas fa-times"></i>
                </button>
                <button (click)="deleteImage(img)" class="btn btn-link close-button text-danger">
                  <i class="fas fa-times"></i>
                </button>
              </div>
              <div *ngIf="uploadImageError">
                <span class="text-danger">{{uploadImageError}}</span>
              </div>
              <div class="app-limit-file">
                <input type="file" (change)="onUploadImage($event)" />
              </div>
              <div>
                <small class="text-warning">Image may take time to show</small>
              </div>
            </div>
          </div>
        </ng-container>
        <!-- Fee/Minimum Settings -->
        <div class="form-group row ml-2">
          <h4>Fee/Minimum Settings
            <button class="btn btn-link" (click)="ifShowFee_MinimumSettings=!ifShowFee_MinimumSettings">
              <i class="fa fa-angle-right" *ngIf="!ifShowFee_MinimumSettings"></i>
              <i class="fa fa-angle-down" *ngIf="ifShowFee_MinimumSettings"></i>
            </button>
          </h4>
        </div>
        <ng-container *ngIf="ifShowFee_MinimumSettings">
          <ng-container *ngIf="!restaurant.feeSchedules">
            <div class="row">
              <label class="col-4 col-form-label pt-0 pl-5">Surcharge</label>
              <div class="pl-1 col-7">
                <label>text to show customer:</label>
                <input type="text" [(ngModel)]="surchargeName" class="form-control mt-1"
                  placeholder="text to show customer">
                <label>fixed amount</label>
                <input type="number" [(ngModel)]="surchargeAmount" class="form-control" placeholder="surcharge amount">
                <label>rate</label>
                <input type="number" style="width: auto;" [(ngModel)]="surchargeRate" class="form-control"
                  placeholder="rate">
                <small>* This is money charged to customer for every online order and the collected
                  money goes to restaurant.
                  <i class="fas fa-exclamation"></i> It may drive customers away.</small>
              </div>
            </div>
            <div class="form-group row">
              <label class="col-4 col-form-label pt-0 pl-5">CC Processing Rate</label>
              <div class="col-7 text-left">
                <input type="number" [(ngModel)]="ccProcessingRate" class="form-control" placeholder="rate">
              </div>
            </div>
            <div class="form-group row">
              <label class="col-4 col-form-label pt-0 pl-5">CC Processing Flat Fee</label>
              <div class="col-7 text-left">
                <input type="number" [(ngModel)]="ccProcessingFlatFee" class="form-control" placeholder="fee">
              </div>
            </div>
          </ng-container>
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Pickup Minimum</label>
            <div class="col-7 text-left">
              <input type="number" [(ngModel)]="pickupMinimum" class="form-control">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">CC Minimum Charge</label>
            <div class="col-7 text-left">
              <input type="number" [(ngModel)]="ccMinimumCharge" class="form-control">
            </div>
          </div>
        </ng-container>
        <!-- Other Preferences -->
        <div class="form-group row ml-2">
          <h4>Other Preferences
            <button class="btn btn-link" (click)="ifShowOtherPreferences=!ifShowOtherPreferences">
              <i class="fa fa-angle-right" *ngIf="!ifShowOtherPreferences"></i>
              <i class="fa fa-angle-down" *ngIf="ifShowOtherPreferences"></i>
            </button>
          </h4>
        </div>
        <ng-container *ngIf="ifShowOtherPreferences">
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Hide Order Status on Customer Side</label>
            <div class="col-7 text-left">
              <input type="checkbox" [(ngModel)]="hideOrderStatus">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Skip Order Confirmation</label>
            <div class="col-7 text-left">
              <input type="checkbox" [(ngModel)]="skipOrderConfirmation">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Not Show Tax Option to Customer</label>
            <div class="col-7 text-left">
              <input type="checkbox" [(ngModel)]="skipShowTax">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Skip Image Injection</label>
            <div class="col-7 text-left">
              <input type="checkbox" [(ngModel)]="skipImageInjection">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Allow submitting order at close time</label>
            <div class="col-7 text-left">
              <input type="checkbox" [(ngModel)]="menuHoursExtended">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Hide printing CC</label>
            <div class="col-7 text-left">
              <input type="checkbox" [(ngModel)]="hidePrintingCCInfo">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-4 col-form-label pt-0 pl-5">Hide Tip Input</label>
            <div class="col-7 text-left">
              <input type="checkbox" [(ngModel)]="hideTipInput">
            </div>
          </div>
        </ng-container>
        <!--Notes  -->
        <div class="form-group row ml-2">
          <h4>Notes</h4>
        </div>
        <div class="row form-group">
          <textarea class="form-control col-12" rows="5" [(ngModel)]="notes"></textarea>
        </div>
        <div class="form-group row  text-right">
          <div class="col-12">
            <button class="btn btn-secondary" (click)="cancel()">Cancel</button>
            <button class="btn btn-primary ml-2" [disabled]="!isEmailValid()" (click)="ok()">OK</button>
          </div>
        </div>
      </div>
      <div class="text-right" *ngIf="!editing && editable">
        <button (click)="toggleEditing()" class="btn btn-primary" role="button">Edit</button>
      </div>
    </li>
  </ul>
</div>
